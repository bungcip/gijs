{"version":3,"file":null,"sources":["../src/string.ts","../src/url.ts","../src/modal.ts","../src/ajax.ts","../src/main.ts"],"sourcesContent":["import * as ko from \"knockout\";\n\n// string replacer\nexport function replace(str: string, dict: Object): string {\n    for (var key in dict) {\n        str = str.replace(\"{\" + key + \"}\", ko.unwrap(dict[key]));\n    }\n\n    return str;\n}\n","/// URL management\n\nimport {replace} from './string';\n\nexport let urlConfig = {\n    baseUrl: \"\"\n};\n\nexport function url(value: string, data?: Object): string {\n    let result = urlConfig.baseUrl + value;\n    return replace(result, data);\n}\n\n","import * as ko from 'knockout';\nimport * as $ from 'jquery';\nimport {replace} from './string';\n\nconst MODAL_ROOT_NAME = \"bs-modal-root-{id}\";\n\n/// menampilkan dialog bootstrap dari sebuah template\nfunction _createBsModal() {\n    let bsTemplate = $('<div class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"><div class=\"modal-dialog\"><div class=\"modal-content\">' +\n        '<div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><h4 class=\"modal-title\"></h4></div>' +\n        '<div class=\"modal-body\"></div>' +\n        '<div class=\"modal-footer\">' +\n        '  <!-- ko foreach: $buttons -->' +\n        '    <button type=\"button\" class=\"btn\" data-bind=\"click: $parent.ok, html: $data.html, css: $data.className\">Ok</button>' +\n        '  <!-- /ko -->' +\n        '  <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Batal</button>' +\n        '</div>' +\n        '</div></div></div>');\n    return bsTemplate;\n}\n\n/// ambil div root untuk menaruh elemen bootstrap modal\nfunction _getModalRoot(counter: number) {\n    counter = counter || 0;\n    let id = replace(MODAL_ROOT_NAME, { id: counter });\n    let dom = document.getElementById(id);\n    /// insert <div> ke dalam <body> bila belum ada\n    if (dom === null) {\n        dom = document.createElement('div');\n        dom.setAttribute('id', id);\n        $(\"body\").append(dom);\n    } else if ($(dom).find('<div>').length !== 0) {\n        return _getModalRoot(counter + 1);\n    }\n    return $(dom);\n}\n\n/// fungsi untuk menampilkan modal bootstrap\n/// ke layar secara dinamis mengembalikan objek Promise\nexport function modal(config: string, model, counter: number): Promise<any> {\n    let promise = new Promise(function (resolve, reject) {\n        /// persiapkan DOM untuk modal dialog\n        let $root = _getModalRoot(counter);\n        let element = _createBsModal();\n        /// set modal minimal objek kosong\n        model = model || {};\n        /// reset binding yang ada di DOM sebelum menghapus data\n        //        ko.cleanNode($root[0]);\n        /// insert template\n        /// sekarang berasumsi config === string\n        let template = document.querySelector('#' + config) as HTMLTemplateElement;\n        let clone = document.importNode(template.content, true);\n        /// ambil tag <modal-title> untuk judul\n        let title = $(clone).find('modal-title').html();\n\n        /// persiapkan button\n        let $buttons = [];\n        let okElements = $(clone).find('modal-ok');\n        okElements.each(function (i, okElement) {\n            let btnConfig = { className: \"btn-primary\" };\n            /// ambil kelas bila diperlukan\n            if (okElement.hasAttribute('class')) {\n                let okClass = okElement.attributes['class'].value;\n                btnConfig.className = okClass;\n            }\n\n            /// ambil tag <modal-ok> untuk tulisan button OK\n            let okLabel = okElement.innerHTML;\n            btnConfig['html'] = okLabel;\n\n            /// value\n            let value = true;\n            if (okElement.hasAttribute('value')) {\n                value = okElement.attributes['value'].value;\n            }\n            btnConfig['value'] = value;\n\n            $buttons.push(btnConfig);\n        });\n\n        /// tambahkan button default bila tidak ada\n        if ($buttons.length === 0) {\n            $buttons.push({ className: \"btn-primary\", value: true, html: \"Ok\" });\n        }\n\n\n        /// ambil tag <modal-body> untuk content\n        let body = $(clone).find('modal-body').html();\n        element.find('.modal-title').html(title);\n        element.find('.modal-body').html(body);\n        /// set class untuk modal-dialog bila ada\n        element.find('.modal-dialog').addClass(template.className);\n        $root.html(element);\n        let bsModal = $root.find('.modal');\n        model.ok = function (d) {\n            if (d) {\n                resolve(d.value);\n            } else {\n                resolve(true);\n            }\n            bsModal.modal('hide');\n        };\n        model.$buttons = $buttons;\n\n        ko.applyBindings(model, $root[0]);\n\n        /// jalankan afterRender\n        if (model.afterRender) {\n            model.afterRender($root);\n        }\n\n        bsModal.modal('show');\n        /// hapus modal saat dihidden\n        bsModal.on(\"hidden.bs.modal\", function () {\n            ko.cleanNode($root[0]);\n            ko.removeNode($root[0]);\n            bsModal.remove();\n        });\n    });\n    return promise;\n};\n","import {ajax} from 'jquery';\r\n\r\n/// Default function to run when request fail.\r\n/// Override this function to change behavior\r\n/// default action is show error dialog\r\nexport function onRequestFail(response: {}) {\r\n    // try {\r\n    //     var jsonData = JSON.parse(response.responseText);\r\n    // }\r\n    // catch (e) {\r\n    //     var jsonData = { message: response.responseText };\r\n    // }\r\n    //        console.log(jsonData);\r\n    //\r\n    //        var modelView = {\r\n    //            bodyTemplate: 'modal-request-fail',\r\n    //            titleLabel: 'Request Gagal',\r\n    //            okLabel: 'OK'\r\n    //        };\r\n    //        _.extend(modelView, jsonData);\r\n    //        exports.modal(modelView);\r\n}\r\n\r\n\r\n/// helper function to send http request.\r\n/// automaticly register function app.onRequestFail to run\r\n/// when request return other than response code 200.\r\nexport function sendJSONRequest(type, url, data) {\r\n    return ajax({\r\n        url: url,\r\n        type: type,\r\n        data: data !== undefined ? JSON.stringify(data) : null,\r\n        contentType: \"application/json\"\r\n    }).fail(onRequestFail);\r\n}\r\n\r\n/// various helper function for sendJSONRequest\r\nexport let getJSON = (url, data) => sendJSONRequest('GET', url, data);\r\nexport let postJSON = (url, data) => sendJSONRequest('POST', url, data);\r\nexport let deleteJSON = (url, data) => sendJSONRequest('DELETE', url, data);\r\nexport let putJSON = (url, data) => sendJSONRequest('PUT', url, data);\r\n","'use strict';\r\n\r\nexport {replace} from './string';\r\nexport {url} from './url';\r\nexport {modal} from './modal';\r\nexport * from './ajax';\r\n\r\nimport {urlConfig} from './url';\r\n\r\n\r\nexport function setup(data: {baseUrl: string}){\r\n    urlConfig.baseUrl = data.baseUrl;\r\n}"],"names":["ajax"],"mappings":";;;AAEA;AACA,iBAAwB,GAAW,EAAE,IAAY;IAC7C,KAAK,IAAI,GAAG,IAAI,IAAI,EAAE;QAClB,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;KAC5D;IAED,OAAO,GAAG,CAAC;CACd;;ACTD;AAIA,AAAO,IAAI,SAAS,GAAG;IACnB,OAAO,EAAE,EAAE;CACd,CAAC;AAEF,aAAoB,KAAa,EAAE,IAAa;IAC5C,IAAI,MAAM,GAAG,SAAS,CAAC,OAAO,GAAG,KAAK,CAAC;IACvC,OAAO,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;CAChC;;ACPD,MAAM,eAAe,GAAG,oBAAoB,CAAC;;AAG7C;IACI,IAAI,UAAU,GAAG,CAAC,CAAC,8HAA8H;QAC7I,2LAA2L;QAC3L,gCAAgC;QAChC,4BAA4B;QAC5B,iCAAiC;QACjC,yHAAyH;QACzH,gBAAgB;QAChB,uFAAuF;QACvF,QAAQ;QACR,oBAAoB,CAAC,CAAC;IAC1B,OAAO,UAAU,CAAC;CACrB;;AAGD,uBAAuB,OAAe;IAClC,OAAO,GAAG,OAAO,IAAI,CAAC,CAAC;IACvB,IAAI,EAAE,GAAG,OAAO,CAAC,eAAe,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,CAAC;IACnD,IAAI,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;;IAEtC,IAAI,GAAG,KAAK,IAAI,EAAE;QACd,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACpC,GAAG,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;QAC3B,CAAC,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;KACzB;SAAM,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;QAC1C,OAAO,aAAa,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;KACrC;IACD,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC;CACjB;;;AAID,eAAsB,MAAc,EAAE,KAAK,EAAE,OAAe;IACxD,IAAI,OAAO,GAAG,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;;QAE/C,IAAI,KAAK,GAAG,aAAa,CAAC,OAAO,CAAC,CAAC;QACnC,IAAI,OAAO,GAAG,cAAc,EAAE,CAAC;;QAE/B,KAAK,GAAG,KAAK,IAAI,EAAE,CAAC;;;;;QAKpB,IAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,GAAG,MAAM,CAAwB,CAAC;QAC3E,IAAI,KAAK,GAAG,QAAQ,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;;QAExD,IAAI,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,IAAI,EAAE,CAAC;;QAGhD,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,IAAI,UAAU,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC3C,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,SAAS;YAClC,IAAI,SAAS,GAAG,EAAE,SAAS,EAAE,aAAa,EAAE,CAAC;;YAE7C,IAAI,SAAS,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE;gBACjC,IAAI,OAAO,GAAG,SAAS,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC;gBAClD,SAAS,CAAC,SAAS,GAAG,OAAO,CAAC;aACjC;;YAGD,IAAI,OAAO,GAAG,SAAS,CAAC,SAAS,CAAC;YAClC,SAAS,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC;;YAG5B,IAAI,KAAK,GAAG,IAAI,CAAC;YACjB,IAAI,SAAS,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE;gBACjC,KAAK,GAAG,SAAS,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC;aAC/C;YACD,SAAS,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC;YAE3B,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAC5B,CAAC,CAAC;;QAGH,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;YACvB,QAAQ,CAAC,IAAI,CAAC,EAAE,SAAS,EAAE,aAAa,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;SACxE;;QAID,IAAI,IAAI,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,EAAE,CAAC;QAC9C,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACzC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;QAEvC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QAC3D,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACpB,IAAI,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QACnC,KAAK,CAAC,EAAE,GAAG,UAAU,CAAC;YAClB,IAAI,CAAC,EAAE;gBACH,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;aACpB;iBAAM;gBACH,OAAO,CAAC,IAAI,CAAC,CAAC;aACjB;YACD,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SACzB,CAAC;QACF,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAE1B,EAAE,CAAC,aAAa,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;;QAGlC,IAAI,KAAK,CAAC,WAAW,EAAE;YACnB,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SAC5B;QAED,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;;QAEtB,OAAO,CAAC,EAAE,CAAC,iBAAiB,EAAE;YAC1B,EAAE,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YACvB,EAAE,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YACxB,OAAO,CAAC,MAAM,EAAE,CAAC;SACpB,CAAC,CAAC;KACN,CAAC,CAAC;IACH,OAAO,OAAO,CAAC;CAClB;AAAA,CAAC;;ACtHF;;;AAGA,uBAA8B,QAAY;;;;;;;;;;;;;;;;CAgBzC;;;;AAMD,yBAAgC,IAAI,EAAE,GAAG,EAAE,IAAI;IAC3C,OAAOA,MAAI,CAAC;QACR,GAAG,EAAE,GAAG;QACR,IAAI,EAAE,IAAI;QACV,IAAI,EAAE,IAAI,KAAK,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,IAAI;QACtD,WAAW,EAAE,kBAAkB;KAClC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;CAC1B;;AAGD,AAAO,IAAI,OAAO,GAAG,CAAC,GAAG,EAAE,IAAI,KAAK,eAAe,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;AACtE,AAAO,IAAI,QAAQ,GAAG,CAAC,GAAG,EAAE,IAAI,KAAK,eAAe,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;AACxE,AAAO,IAAI,UAAU,GAAG,CAAC,GAAG,EAAE,IAAI,KAAK,eAAe,CAAC,QAAQ,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;AAC5E,AAAO,IAAI,OAAO,GAAG,CAAC,GAAG,EAAE,IAAI,KAAK,eAAe,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;eC9BhD,IAAuB;IACzC,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;CACpC;;;;;;;;;;;;;"}